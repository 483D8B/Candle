<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="candle_relative.css">
    <link rel="shortcut icon" href="#">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
        @import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css");
        @import url('https://fonts.cdnfonts.com/css/herculanum-lt-pro');

        body {
            background: #222;
            padding-top: 5em;
            padding-bottom: 5em;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 8em;
        }

        .box {
            display: flex;
            flex-flow: row wrap;
            justify-content: start;
            gap: 4em;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(10, 3.8vw);
            gap: 0.2em;
            opacity: 0.02;
        }

        .cell {
            aspect-ratio: 1/1;
            border: 2px solid #EEEBDD;
        }

        .test {
            position: relative;
            box-sizing: border-box;
            display: block;
            top: 20px;
        }

        .title {
            display: block;
            font-size: 3em;
            font-family: 'Herculanum LT Pro', sans-serif;
            text-align: center;
            text-transform: uppercase;
            margin-bottom: -2.5em;
            color: #EEEBDD;
        }

        .speech {
            font-size: 1em;
            color: #222;
            background: #f08000;
            font-family: Arial, Helvetica, sans-serif;
            border-radius: 10px;
            padding: 0.5em;
            height: fit-content;
            top: 45%;
            left: 65%;
            user-select: none;
            font-weight: bold;
        }

        .speech::after {
            display: block;
            width: 0;
            content: "";
            border: 10px solid transparent;
        }

        .speech.left::after {
            border-right-color: #f08000;
            border-width: 0 10px 10px 10px;
            border-style: solid;
            border-color: #f08000 transparent;
            border-radius: 50px 1px 50px 0;
        }

        .speech {
            position: relative;
        }

        .speech::after {
            position: absolute;
        }

        .speech.left::after {
            left: -8px;
            top: calc(50% - 5px);
        }

        .speech.left.sleep {
            font-family: 'Herculanum LT Pro', sans-serif;
            left: 80%;
        }


        ul {
            margin: 0;
            padding: 0;
            list-style: none;
        }

        a {
            color: #2c3e50;
            text-decoration: none;
        }

        .booktitle,
        .bookinside {
            display: inline-block;
            margin-top: 40px;
            font-size: 0.8em;
            font-weight: bold;
            text-align: center;
            -webkit-transform: rotate(20deg);
            -moz-transform: rotate(20deg);
            transform: rotate(20deg);
            font-family: 'Herculanum LT Pro', sans-serif;
            -webkit-transition: color 0.3s;
            -moz-transition: color 0.3s;
            transition: color 0.3s;
            color: #222;
        }

        .bookinside {
            font-size: 2em;
            display: block;
            color: #222;
            margin: 0 auto;
            padding-bottom: 1em;
        }

        .book {
            position: relative;
            display: block;
            width: 64px;
            height: 88px;
            -webkit-perspective: 1000px;
            -moz-perspective: 1000px;
            perspective: 1000px;
            -webkit-transform-style: preserve-3d;
            -moz-transform-style: preserve-3d;
            transform-style: preserve-3d;
            top: 55%;
            left: 40%;
            margin: auto;
            box-shadow: 1px 1px 10px rgba(240, 248, 255,0.2);
        }

        .paperback_front {
            background-color: #000;
        }

        .paperback_front::after {
            background-image: -webkit-linear-gradient(-135deg, rgba(255, 255, 255, 0.45) 0%, transparent 100%);
            background-image: -moz-linear-gradient(-135deg, rgba(255, 255, 255, 0.45) 0%, transparent 100%);
            background-image: linear-gradient(-135deg, rgba(255, 255, 255, 0.45) 0%, transparent 100%);
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
        }

        .paperback_back {
            background-color: #333;
        }

        /* page */

        .ruled_paper>li {
            background-color: #fff;
            background-size: 100% 0.6em;
            box-shadow: inset 0px -1px 2px rgba(50, 50, 50, 0.5), inset -1px 0px 1px rgba(150, 150, 150, 1);
            border-radius: 0px 10px 10px 0px;
        }

        /*
	3. opening cover, back cover and pages
*/

        .paperback_front {
            -webkit-transform: rotateY(-38deg) translateZ(0px);
            -moz-transform: rotateY(-38deg) translateZ(0px);
            transform: rotateY(-38deg) translateZ(0px);
            z-index: 100;
        }

        .paperback_back {
            -webkit-transform: rotateY(-25deg);
            -moz-transform: rotateY(-25deg);
            transform: rotateY(-25deg);
        }

        .ruled_paper li:nth-child(1) {
            -webkit-transform: rotateY(-27deg);
            -moz-transform: rotateY(-27deg);
            transform: rotateY(-27deg);
        }

        .ruled_paper li:nth-child(2) {
            -webkit-transform: rotateY(-29deg);
            -moz-transform: rotateY(-29deg);
            transform: rotateY(-29deg);
        }

        .ruled_paper li:nth-child(3) {
            -webkit-transform: rotateY(-31deg);
            -moz-transform: rotateY(-31deg);
            transform: rotateY(-31deg);
        }

        .ruled_paper li:nth-child(4) {
            -webkit-transform: rotateY(-33deg);
            -moz-transform: rotateY(-33deg);
            transform: rotateY(-33deg);
        }

        .ruled_paper li:nth-child(5) {
            -webkit-transform: rotateY(-35deg);
            -moz-transform: rotateY(-35deg);
            transform: rotateY(-35deg);
        }

        /*
	4. position, transform y transition
*/

        .paperback_front,
        .paperback_back,
        .paperback_front li,
        .paperback_back li {
            border-radius: 2px 8px 8px 2px;
            position: absolute;
            top: 0;
            left: 0px;
            width: 100%;
            height: 100%;
            -webkit-transform-style: preserve-3d;
            -moz-transform-style: preserve-3d;
            transform-style: preserve-3d;
        }

        .paperback_front,
        .paperback_back {
            -webkit-transform-origin: 0% 100%;
            -moz-transform-origin: 0% 100%;
            transform-origin: 0% 100%;
        }

        .paperback_front {
            -webkit-transition: all 0.5s ease, z-index 0.6s;
            -moz-transition: all 0.5s ease, z-index 0.6s;
            transition: all 0.5s ease, z-index 0.6s;
        }

        .paperback_front li img,
        .paperback_back li img {
            border-radius: 2px 8px 8px 2px;
            position: absolute;
            top: 0;
            left: 0;
        }

        .ruled_paper,
        .ruled_paper>li {
            position: absolute;
            -webkit-transform-style: preserve-3d;
            -moz-transform-style: preserve-3d;
            transform-style: preserve-3d;
        }

        .ruled_paper {
            width: 98%;
            height: 98%;
            top: 1%;
            left: 1%;
            z-index: 10;
        }

        .ruled_paper>li {
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .ruled_paper>li {
            -webkit-transform-origin: left center;
            -moz-transform-origin: left center;
            transform-origin: left center;
            -webkit-transition-property: transform;
            -moz-transition-property: transform;
            transition-property: transform;
            -webkit-transition-timing-function: ease;
            -moz-transition-timing-function: ease;
            transition-timing-function: ease;
        }

        .ruled_paper li:nth-child(1) {
            -webkit-transition-duration: 0.6s;
            -moz-transition-duration: 0.6s;
            transition-duration: 0.6s;
        }

        .ruled_paper li:nth-child(2) {
            -webkit-transition-duration: 0.6s;
            -moz-transition-duration: 0.6s;
            transition-duration: 0.6s;
        }

        .ruled_paper li:nth-child(3) {
            -webkit-transition-duration: 0.4s;
            -moz-transition-duration: 0.4s;
            transition-duration: 0.4s;
        }

        .ruled_paper li:nth-child(4) {
            -webkit-transition-duration: 0.5s;
            -moz-transition-duration: 0.5s;
            transition-duration: 0.5s;
        }

        .ruled_paper li:nth-child(5) {
            -webkit-transition-duration: 0.5s;
            -moz-transition-duration: 0.5s;
            transition-duration: 0.5s;
        }

        .book:hover>.paperback_front {
            -webkit-transform: rotateY(-125deg) translateZ(0px);
            -moz-transform: rotateY(-125deg) translateZ(0px);
            transform: rotateY(-125deg) translateZ(0px);
            z-index: 0;
        }

        .book:hover>.ruled_paper li:nth-child(1) {
            -webkit-transform: rotateY(-30deg);
            -moz-transform: rotateY(-30deg);
            transform: rotateY(-30deg);
            -webkit-transition-duration: 1.5s;
            -moz-transition-duration: 1.5s;
            transition-duration: 1.5s;
        }

        .book:hover>.ruled_paper li:nth-child(2) {
            -webkit-transform: rotateY(-35deg);
            -moz-transform: rotateY(-35deg);
            transform: rotateY(-35deg);
            -webkit-transition-duration: 1.8s;
            -moz-transition-duration: 1.8s;
            transition-duration: 1.8s;
        }

        .book:hover>.ruled_paper li:nth-child(3) {
            -webkit-transform: rotateY(-110deg);
            -moz-transform: rotateY(-110deg);
            transform: rotateY(-110deg);
            -webkit-transition-duration: 2.2s;
            -moz-transition-duration: 2.2s;
            transition-duration: 2.2s;
        }

        .book:hover>.ruled_paper li:nth-child(4) {
            -webkit-transform: rotateY(-115deg);
            -moz-transform: rotateY(-115deg);
            transform: rotateY(-115deg);
            -webkit-transition-duration: 1.8s;
            -moz-transition-duration: 1.8s;
            transition-duration: 1.8s;
        }

        .book:hover>.ruled_paper li:nth-child(5) {
            -webkit-transform: rotateY(-120deg);
            -moz-transform: rotateY(-120deg);
            transform: rotateY(-120deg);
            -webkit-transition-duration: 1.2s;
            -moz-transition-duration: 1.2s;
            transition-duration: 1.2s;
        }

        /* Cover colors */
        .green {
            background: #f08000;
            border: 1px solid #111;
        }

        .zzz {
            animation-name: zzz;
            animation-duration: 2s;
            animation-timing-function: linear;
            animation-iteration-count: infinite;
            animation-direction: normal;
            color: #222;
            font-weight: bold;
            position: absolute;
            display: block;
            z-index: 100;
            transform: translateY(100%);
            font-family: 'Herculanum LT Pro', sans-serif;
            margin: auto;
            left: 2em;
            top: 40%;
        }

        .zzz-z {
            animation-delay: 0.5s;
            right: 10px;
        }

        .zzz-zz {
            animation-delay: 1s;
            right: -20px;
        }

        .zzz-zzz {
            animation-delay: 1.5s;
            right: 0;
        }


        /* *** All Animations *** */
        /*Darker Sky*/
        @-webkit-keyframes zzz {
            0% {
                color: var(--zzz);
                font-size: 1em;
                -webkit-transform: translateY(100%);
                transform: translateY(100%);
            }

            50% {
                color: var(--zzz);
                font-size: 1.5em;
                -webkit-transform: translateY(50%);
                transform: translateY(50%);
            }

            100% {
                color: var(--zzz);
                font-size: 2em;
                -webkit-transform: translateY(-100%);
                transform: translateY(-100%);
                opacity: 0.05;
            }
        }

        @keyframes zzz {
            0% {
                color: var(--zzz);
                font-size: 1em;
                -webkit-transform: translateY(100%);
                transform: translateY(100%);
            }

            50% {
                color: var(--zzz);
                font-size: 1.5em;
                -webkit-transform: translateY(50%);
                transform: translateY(50%);
            }

            100% {
                color: var(--zzz);
                font-size: 2em;
                -webkit-transform: translateY(-100%);
                transform: translateY(-100%);
                opacity: 0.05;
            }
        }

        @keyframes stretch {
            0% {
                width: 200px;
            }

            100% {
                width: 100px;
            }
        }

        @-webkit-keyframes stretch {
            0% {
                width: 200px;
            }

            100% {
                width: 100px;
            }
        }

        @keyframes swing {
            0% {
                transform: rotateX(0deg);
                border-radius: 70% 30% 0 0;
            }

            12.25% {
                border-radius: 30% 70% 0 0;
            }

            25% {
                border-radius: 70% 30% 0 0;
            }

            37.25% {
                border-radius: 30% 70% 0 0;
            }

            50% {
                border-radius: 70% 30% 0 0;
            }

            67.25% {
                border-radius: 30% 70% 0 0;
            }

            75% {
                border-radius: 70% 30% 0 0;
            }

            87.25% {
                border-radius: 30% 70% 0 0;
            }

            100% {
                transform: rotateX(-360deg);
                border-radius: 70% 30% 0 0;
            }
        }

        @-webkit-keyframes swing {
            0% {
                transform: rotateX(0deg);
                border-radius: 70% 30% 0 0;
            }

            12.25% {
                border-radius: 30% 70% 0 0;
            }

            25% {
                border-radius: 70% 30% 0 0;
            }

            37.25% {
                border-radius: 30% 70% 0 0;
            }

            50% {
                border-radius: 70% 30% 0 0;
            }

            67.25% {
                border-radius: 30% 70% 0 0;
            }

            75% {
                border-radius: 70% 30% 0 0;
            }

            87.25% {
                border-radius: 30% 70% 0 0;
            }

            100% {
                transform: rotateX(-360deg);
                border-radius: 70% 30% 0 0;
            }
        }
        

    </style>
</head>

<body>

    <div class="container">
        <div class="title">Japanese</div>
        <div class="box">
            <div class="grid" id="grid1"></div>
            <div class="test">
                <div class="shadows"></div>
                <div class="main" data-index="0"></div>
                <div class="details"></div>
                <div class="candle"></div>
                <div class="eye"></div>
                <div class="eye eye-2"></div>
                <div class="mouth"></div>
                <div class="speech left">日本語</div>
            </div>
        </div>
        <div class="title">Stretching</div>
        <div class="box">
            <div class="grid" id="grid2"></div>
            <div class="test">
                <div class="shadows"></div>
                <div class="main stretch" data-index="0"></div>
                <div class="details"></div>
                <div class="candle"></div>
                <div class="eye"></div>
                <div class="eye eye-2"></div>
                <div class="mouth"></div>
            </div>
        </div>
        <div class="title">Exercise</div>
        <div class="box">
            <div class="grid" id="grid3"></div>
            <div class="test">
                <div class="shadows"></div>
                <div class="main muscle" data-index="0"></div>
                <div class="details"></div>
                <div class="candle"></div>
                <div class="eye"></div>
                <div class="eye eye-2"></div>
                <div class="mouth"></div>
            </div>
        </div>
        <div class="title">Sleep routine</div>
        <div class="box">
            <div class="grid" id="grid4"></div>
            <div class="test">
                <div class="shadows"></div>
                <div class="main" data-index="0"></div>
                <div class="details"></div>
                <div class="candle"></div>
                <div class="eye sleep"></div>
                <div class="eye eye-2 sleep"></div>
                <div class="mouth"></div>
                <div class="zzz zzz-zzz">Z</div>
                <div class="zzz zzz-zz">Z</div>
                <div class="zzz zzz-z">Z</div>
            </div>
        </div>
        <div class="title">Reading</div>
        <div class="box">
            <div class="grid" id="grid5"></div>
            <div class="test">
                <div class="shadows"></div>
                <div class="main" data-index="0"></div>
                <div class="details"></div>
                <div class="candle"></div>
                <div class="eye"></div>
                <div class="eye eye-2"></div>
                <div class="mouth"></div>
                <figure class='book'>
                    <ul class='paperback_front green'>
                        <a class="booktitle">Reading...</a>
                        <li></li>
                        <li></li>
                    </ul>
                    <ul class='ruled_paper'>
                        <li></li>
                        <li>
                            <a class="bookinside">:)</a>
                        </li>
                        <li></li>
                        <li></li>
                        <li></li>
                    </ul>
                    <ul class='paperback_back green'>
                        <li></li>
                        <li></li>
                    </ul>
                </figure>
            </div>
        </div>
    </div>
    <script>


        let path = 'https://483d8b.pythonanywhere.com'

        window.addEventListener('DOMContentLoaded', (event) => {
            let gridStates = []; // Store grid states locally

            // Function to fetch initial candle and grid states
            function fetchInitialStates() {
                return Promise.all([
                    fetch(path + '/api/candle_states').then(response => response.json()),
                    fetch(path + '/api/grid_states').then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response.json();
                    })
                ])
                    .then(([candleData, gridData]) => {
                        // Store grid states locally for easy access
                        gridStates = gridData.grid_states;

                        // Process each test element
                        document.querySelectorAll('.test').forEach(function (testElement) {
                            const mainElement = testElement.querySelector('.main');
                            const candleElement = testElement.querySelector('.candle');
                            const shadowsElement = testElement.querySelector('.shadows');
                            const mouthElement = testElement.querySelector('.mouth');
                            const gridId = testElement.parentElement.querySelector('.grid').id;

                            // Set initial candle state
                            const candleState = candleData.candle_states.find(candle => candle.id === gridId);
                            if (candleState && candleState.is_lit) {
                                candleElement.classList.add('lit');
                                shadowsElement.classList.add('lit');
                                mouthElement.classList.add('happy');
                            }

                            // Set initial grid state
                            const gridState = gridStates.find(grid => grid.id === gridId);
                            if (gridState) {
                                const coloredCells = gridState.colored_cells;
                                const gridElement = testElement.parentElement.querySelector('.grid');
                                const cells = gridElement.querySelectorAll('.cell');
                                for (let i = 0; i < coloredCells; i++) {
                                    if (cells[i]) {
                                        cells[i].style.backgroundColor = '#F08000';
                                    }
                                }
                            }

                            // Toggle grid opacity
                            toggleGridOpacity(testElement.parentElement);
                        });
                    })
                    .catch(error => console.error('Error fetching initial states:', error));
            }

            // Fetch initial states when DOM content is loaded
            fetchInitialStates();

            // Create grid cells when DOM content is loaded
            createDivs();
        });

        // Function to create grid cells
        function createDivs() {
            const grids = document.querySelectorAll('.grid');
            grids.forEach((grid) => {
                for (let i = 0; i < 100; i++) {
                    const div = document.createElement('div');
                    div.className = 'cell';
                    grid.appendChild(div);
                }
            });
        }

        // Function to toggle grid opacity
        function toggleGridOpacity(boxElement) {
            // Find the .grid within the .box
            var gridElement = boxElement.querySelector('.grid');

            // Find the .candle within the .box
            var candleElement = boxElement.querySelector('.candle');

            // Check if the .candle has the 'lit' class
            if (candleElement.classList.contains('lit')) {
                // If the .candle is 'lit', set the .grid opacity to 1
                gridElement.style.opacity = '1';
            } else {
                // If the .candle is not 'lit', set the .grid opacity to 0.02
                gridElement.style.opacity = '0.02';
            }
        }

    </script>


</body>

</html>